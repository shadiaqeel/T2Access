@model T2Access.Models.UserViewModel
@using T2Access.Web.Resources


@{
    ViewBag.Title = "User  Managment";
}


@section Styles {




    <link href="~/Assets/lib/MDB/css/addons/datatables-select.min.css" rel="stylesheet" />
    <link href="~/Assets/lib/MDB/css/addons/datatables.min.css" rel="stylesheet" />


}


<div class="row mt">
    <div class="col-md-12">
        <div class="content-panel  ">
            <table class="table table-striped table-advance table-hover" id="DTable">

                <h4 style="display:inline-block;"> @Resource.UserTable </h4>
                @Html.ActionLink($"   {Resource.CreateUser}", "Create", "User", null, new { @class = "fa  fa-plus btn  btn-success pull-right" })

                @if (!string.IsNullOrEmpty(ViewBag.StateMessage))
                {
                    <div class="alert alert-success" role="alert">ViewBag.StateMessage)</div>
                }
                @if (!string.IsNullOrEmpty(ViewBag.ErrorMessage))
                {
                    <div class="alert alert-danger" role="alert">ViewBag.ErrorMessage</div>

                }

                <br>
                <thead>
                    <tr>
                        <th data-sortable="true">
                            <span class=" fa fa-user"></span>
                            @Html.DisplayNameFor(model => model.UserName)
                        </th>
                        <th>
                            <span class=" fa fa-user"></span>
                            @Html.DisplayNameFor(model => model.FirstName)
                        </th>
                        <th>
                            <span class=" fa fa-user"></span>
                            @Html.DisplayNameFor(model => model.LastName)
                        </th>
                        <th>
                            <span class=" fa fa-edit"></span>
                            @Html.DisplayNameFor(model => model.Status)
                        </th>
                        <th>
                            <span class=" fa fa-flash"></span>
                            @Resource.Actions
                        </th>
                    </tr>
                </thead>
                <tbody id="tbodyPartial">


                    @Html.Action("GetAll")



                </tbody>
            </table>
        </div>
    </div>
</div>






@Html.Partial("_AddEditModal")

@section Scripts
  {


    @Scripts.Render("~/Assets/lib/MDB/js/addons/datatables.min.js")
    @Scripts.Render("~/Assets/lib/MDB/js/addons/datatables-select.min.js")

    <script>



         var dataTableConfig = {
                    destroy:true,
                    bFilter: true,
                    bInfo: true,
                    bAutoWidth: true,
                    bSortable: false,
                    columnDefs: [
                        { "orderable": false, "targets": 4 }
                    ],
                    language: {
                        "lengthMenu": "Display _MENU_ records per page",
                        "zeroRecords": "Nothing found - sorry",
                        // "info": "Showing page _PAGE_ of _PAGES_",
                        "infoEmpty": "No records available",
                        "infoFiltered": "(filtered from _MAX_ total records)"
                    }
                }



                  $(document).ready(function () {
                $("#DTable").DataTable(dataTableConfig);

            });



            // Variables
            var createUrl = "@Url.Action("Create", "User")";
            var editUserUrl = "@Url.Action("Edit", "User")";
            var deleteUrl = "@Url.Action("Delete", "User")";
            var resetpasswordUrl = "@Url.Action("ResetPassword", "User")";
            var ReLoginUrl = "@Url.Action("ReLogin", "Account")";
            var TableUrl = "@Url.Action("GetAll", "User")";

            var confirmMessage = "@Resource.ConfirmDelete";


            var editModal = function (data) {
                    console.log(data);
                $("#addEditModalContent").load(editUserUrl,function () {


                    $("#Id").val(data.Id);
                    $("#UserName").val(data.UserName);
                    $("#FirstName").val(data.FirstName);
                    $("#LastName").val(data.LastName);
                    $("#Status").val(data.Status);

                    $("#addEditModal").modal("show");


                    bindForm(this);

                 });
        }


        

    </script>






}